<div class="card">
    <h3>Join the Sungroup Team</h3>
    <form id="applicationForm">
        <input type="text" id="appName" placeholder="Full Name" required>
        <input type="email" id="appEmail" placeholder="Email Address" required>
        <select id="appRole">
            <option value="Electrical Engineer">Electrical Engineer</option>
            <option value="Mechanical Technician">Mechanical Technician</option>
            <option value="Site Supervisor">Site Supervisor</option>
            <option value="Admin/HR">Admin/HR</option>
        </select>
        <input type="url" id="appResume" placeholder="Resume Link (Google Drive/Dropbox)" required>
        <textarea id="appMessage" placeholder="Briefly tell us about your experience..." rows="4"></textarea>
        <button type="submit" class="btn btn-save" style="background:var(--primary); color:white;">Submit Application</button>
    </form>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCkND2Ip7G09rELaU-S9c0LXk1ffrFSc4g",
        authDomain: "sungroup-crm.firebaseapp.com",
        projectId: "sungroup-crm",
        storageBucket: "sungroup-crm.firebasestorage.app",
        messagingSenderId: "982155471354",
        appId: "1:982155471354:web:c4b61192d247c9739edc43"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    document.getElementById('applicationForm').onsubmit = async (e) => {
        e.preventDefault();
        const email = document.getElementById('appEmail').value;
        
        try {
            await setDoc(doc(db, "applications", email), {
                name: document.getElementById('appName').value,
                email: email,
                role: document.getElementById('appRole').value,
                resume: document.getElementById('appResume').value,
                message: document.getElementById('appMessage').value,
                appliedDate: new Date().toISOString()
            });
            alert("Application sent successfully! We will contact you soon.");
            e.target.reset();
        } catch (error) {
            alert("Error sending application. Please try again.");
        }
    };
</script>
